<aside class="col-md-3">
    <style>
        /* Khối bao quanh */
        .sidebar-widget {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            padding: 20px;
            border: 1px solid #f0f2f5;
        }

        /* Các đường link trong menu */
        .sidebar-menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            margin-bottom: 8px;
            color: #344767; /* Màu chữ tối chuẩn */
            font-weight: 500;
            font-size: 14px;
            border-radius: 12px; /* Bo tròn mềm mại */
            transition: all 0.3s ease;
            text-decoration: none !important;
            border: 1px solid transparent;
        }

        /* Icon bên trái */
        .sidebar-menu-item i {
            width: 24px;
            margin-right: 10px;
            font-size: 16px;
            text-align: center;
            transition: 0.3s;
            color: #8392ab; /* Màu xám nhạt cho icon */
        }

        /* Hiệu ứng Hover: Nền xám nhẹ, chữ xanh */
        .sidebar-menu-item:hover {
            background-color: #f8f9fa;
            color: #2152ff;
            transform: translateX(5px); /* Trượt nhẹ sang phải */
        }
        .sidebar-menu-item:hover i { color: #2152ff; }

        /* --- TRẠNG THÁI ACTIVE (QUAN TRỌNG) --- */
        /* Dùng Gradient xanh dương giống Dashboard */
        .sidebar-menu-item.active {
            background: linear-gradient(135deg, #2152ff 0%, #21d4fd 100%);
            color: #fff !important;
            box-shadow: 0 4px 15px rgba(33, 82, 255, 0.3); /* Bóng xanh phát sáng */
            font-weight: 600;
        }
        .sidebar-menu-item.active i {
            color: #fff !important;
        }

        /* Nút Logout riêng biệt */
        .btn-logout-custom {
            border: 1px solid #ffecec;
            background: #fff5f5;
            color: #dc3545;
            border-radius: 12px;
            padding: 12px;
            font-weight: 600;
            transition: 0.3s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-logout-custom:hover {
            background: #dc3545;
            color: #fff;
            box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
        }
    </style>

    <div class="sidebar-widget animate-up delay-1">

        <div class="text-center mb-4 pb-3 border-bottom">
            {% if user.userprofile.profile_picture %}
                <img src="{{ user.userprofile.profile_picture.url }}" class="rounded-circle mb-2" style="width: 60px; height: 60px; object-fit: cover; border: 3px solid #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            {% else %}
                <div class="rounded-circle mx-auto mb-2 d-flex align-items-center justify-content-center text-primary font-weight-bold" style="width: 60px; height: 60px; background: #e7f1ff; font-size: 20px;">
                    {{ user.first_name|slice:":1" }}
                </div>
            {% endif %}
            <h6 class="font-weight-bold mb-0">{{ user.first_name }} {{ user.last_name }}</h6>
            <small class="text-muted">{{ user.email }}</small>
        </div>

        <nav class="nav flex-column">

            <a class="sidebar-menu-item {% if '/accounts/' == request.path %}active{% endif %}" href="{% url 'dashboard' %}">
                <i class="fas fa-th-large"></i> Dashboard
            </a>

            <a class="sidebar-menu-item {% if '/my_orders/' in request.path %}active{% endif %}" href="{% url 'my_orders' %}">
                <i class="fas fa-shopping-bag"></i> My Orders
            </a>

            <a class="sidebar-menu-item {% if '/my_coupons/' in request.path %}active{% endif %}" href="{% url 'my_coupons' %}">
                <i class="fas fa-ticket-alt"></i> My Coupons
            </a>

            <a class="sidebar-menu-item {% if '/return/my-returns/' in request.path %}active{% endif %}" href="{% url 'returns:my_returns' %}">
                <i class="fas fa-undo"></i> My Returns
            </a>

            <a class="sidebar-menu-item {% if '/edit_profile/' in request.path %}active{% endif %}" href="{% url 'edit_profile' %}">
                <i class="fas fa-user-edit"></i> Edit Profile
            </a>

            <a class="sidebar-menu-item {% if '/change_password/' in request.path %}active{% endif %}" href="{% url 'change_password' %}">
                <i class="fas fa-lock"></i> Change Password
            </a>

        </nav>

        <br>

        <a class="btn-logout-custom btn-block" href="{% url 'logout' %}">
            <i class="fas fa-power-off"></i> Log out
        </a>

    </div>
    </aside>